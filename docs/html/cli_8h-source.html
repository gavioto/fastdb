<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cli.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>cli.h</h1><div class="fragment"><pre>00001 <span class="comment">/*-&lt; CLI.H &gt;---------------------------------------------------------*--------*</span>
00002 <span class="comment"> * FastDB                    Version 1.0         (c) 1999  GARRET    *     ?  *</span>
00003 <span class="comment"> * (Main Memory Database Management System)                          *   /\|  *</span>
00004 <span class="comment"> *                                                                   *  /  \  *</span>
00005 <span class="comment"> *                          Created:     13-Jan-2000 K.A. Knizhnik   * / [] \ *</span>
00006 <span class="comment"> *                          Last update: 13-Jan-2000 K.A. Knizhnik   * GARRET *</span>
00007 <span class="comment"> *-------------------------------------------------------------------*--------*</span>
00008 <span class="comment"> * Call level interface to FastDB server</span>
00009 <span class="comment"> *-------------------------------------------------------------------*--------*/</span>
00010 
00011 <span class="preprocessor">#ifndef __CLI_H__</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define __CLI_H__</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include "config.h"</span>
00015 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00016 <span class="preprocessor">#include &lt;time.h&gt;</span>
00017 
00018 <span class="preprocessor">#ifndef FASTDB_DLL_ENTRY</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#ifdef FASTDB_DLL</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#ifdef INSIDE_FASTDB</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define FASTDB_DLL_ENTRY __declspec(dllexport)</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define FASTDB_DLL_ENTRY __declspec(dllimport)</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define FASTDB_DLL_ENTRY</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>
00030 <span class="preprocessor">#ifndef CLI_CALLBACK_CC </span><span class="comment">/* CLI callbacks calling convention */</span>
00031 <span class="preprocessor">#define CLI_CALLBACK_CC </span>
00032 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00033 <span class="preprocessor"></span>
00034 <span class="preprocessor">#ifdef __cplusplus</span>
00035 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> { 
00036 <span class="preprocessor">#endif</span>
00037 <span class="preprocessor"></span>
00038 <span class="keyword">enum</span> cli_result_code { 
00039     cli_ok = 0,
00040     cli_bad_address = -1,
00041     cli_connection_refused = -2,
00042     cli_database_not_found = -3, 
00043     cli_bad_statement = -4,
00044     cli_parameter_not_found = -5,
00045     cli_unbound_parameter = -6,
00046     cli_column_not_found = -7,
00047     cli_incompatible_type = -8,
00048     cli_network_error = -9,
00049     cli_runtime_error = -10,
00050     cli_bad_descriptor = -11,
00051     cli_unsupported_type = -12,
00052     cli_not_found        = -13,
00053     cli_not_update_mode  = -14,
00054     cli_table_not_found  = -15,
00055     cli_not_all_columns_specified = -16, 
00056     cli_not_fetched = -17,
00057     cli_already_updated = -18, 
00058     cli_table_already_exists = -19, 
00059     cli_not_implemented = -20
00060 };
00061     
00062 <span class="keyword">enum</span> cli_var_type { 
00063     cli_oid,
00064     cli_bool, 
00065     cli_int1, 
00066     cli_int2,
00067     cli_int4,
00068     cli_int8,
00069     cli_real4,
00070     cli_real8,
00071     cli_decimal, <span class="comment">/* not supported */</span>
00072     cli_asciiz,  <span class="comment">/* zero terminated string */</span>
00073     cli_pasciiz, <span class="comment">/* pointer to zero terminated string */</span>
00074     cli_cstring, <span class="comment">/* not supported */</span>
00075     cli_array_of_oid,
00076     cli_array_of_bool, 
00077     cli_array_of_int1, 
00078     cli_array_of_int2,
00079     cli_array_of_int4,
00080     cli_array_of_int8,
00081     cli_array_of_real4,
00082     cli_array_of_real8,
00083     cli_array_of_decimal, 
00084     cli_array_of_string,
00085     cli_any,      <span class="comment">/* use the same type for column as stored in the database */</span>
00086     cli_datetime,  <span class="comment">/* time in seconds since 00:00:00 UTC, January 1, 1970. */</span>
00087     cli_autoincrement,  <span class="comment">/* column of int4 type automatically assigned value during record insert */</span>
00088     cli_rectangle,
00089     cli_unknown
00090 };
00091 
00092 <span class="preprocessor">#ifdef __STDTP_H__</span>
00093 <span class="preprocessor"></span>USE_FASTDB_NAMESPACE
00094 <span class="preprocessor">#endif</span>
00095 <span class="preprocessor"></span>
00096 <span class="keyword">typedef</span> <span class="keywordtype">char</span>         cli_bool_t;
00097 <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">char</span>  cli_int1_t;
00098 <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">short</span> cli_int2_t;
00099 <span class="keyword">typedef</span> <span class="keywordtype">float</span>        cli_real4_t;
00100 <span class="keyword">typedef</span> <span class="keywordtype">double</span>       cli_real8_t;
00101     
00102 <span class="preprocessor">#ifndef RECTANGLE_COORDINATE_TYPE</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#define RECTANGLE_COORDINATE_TYPE int</span>
00104 <span class="preprocessor"></span><span class="comment">//#define RECTANGLE_COORDINATE_TYPE double</span>
00105 <span class="preprocessor">#endif</span>
00106 <span class="preprocessor"></span><span class="keyword">typedef</span> RECTANGLE_COORDINATE_TYPE cli_coord_t;
00107 <span class="preprocessor">#define CLI_RECTANGLE_DIMENSION 2</span>
00108 <span class="preprocessor"></span>
00109 <span class="keyword">typedef</span> <span class="keyword">struct </span>{ 
00110     cli_coord_t  boundary[CLI_RECTANGLE_DIMENSION*2];
00111 } cli_rectangle_t;
00112 
00113 <span class="preprocessor">#if !defined(SIZEOF_LONG) &amp;&amp; defined(L64) &amp;&amp; ! defined(WIN64)</span>
00114 <span class="preprocessor"></span><span class="preprocessor">#define SIZEOF_LONG 8</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00116 <span class="preprocessor"></span>
00117 <span class="preprocessor">#if (defined(_WIN32) || defined(__BORLANDC__)) &amp;&amp; !defined(__MINGW32__)</span>
00118 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">signed</span> __int32   cli_int4_t;
00119 <span class="keyword">typedef</span> <span class="keywordtype">signed</span> __int64   cli_int8_t;
00120 <span class="preprocessor">#else</span>
00121 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">int</span>       cli_int4_t;
00122 <span class="preprocessor">#if SIZEOF_LONG == 8</span>
00123 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">long</span>      cli_int8_t;
00124 <span class="preprocessor">#else</span>
00125 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> cli_int8_t;
00126 <span class="preprocessor">#endif</span>
00127 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00128 <span class="preprocessor"></span>
00129 <span class="preprocessor">#ifndef CLI_TIME_T_DEFINED</span>
00130 <span class="preprocessor"></span>    <span class="keyword">typedef</span> time_t cli_time_t;
00131 <span class="preprocessor">#endif</span>
00132 <span class="preprocessor"></span>
00133 <span class="preprocessor">#ifndef CLI_OID_DEFINED</span>
00134 <span class="preprocessor"></span><span class="preprocessor">#if dbDatabaseOidBits &gt; 32</span>
00135 <span class="preprocessor"></span><span class="keyword">typedef</span> size_t cli_oid_t;
00136 <span class="preprocessor">#else</span>
00137 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> cli_oid_t;
00138 <span class="preprocessor">#endif</span>
00139 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00140 <span class="preprocessor"></span>
00141 <span class="comment">// structure used to represent array field in structure extracted by cli_execute_query</span>
00142 <span class="keyword">typedef</span> <span class="keyword">struct </span>cli_array_t { 
00143     size_t size;      <span class="comment">// number of elements in the array</span>
00144     <span class="keywordtype">void</span>*  data;      <span class="comment">// pointer to the array elements</span>
00145     size_t allocated; <span class="comment">// internal field: size of allocated buffer </span>
00146 } cli_array_t;
00147     
00148 <span class="comment">/*********************************************************************</span>
00149 <span class="comment"> * cli_open</span>
00150 <span class="comment"> *     Establish connection with the server </span>
00151 <span class="comment"> * Parameters:</span>
00152 <span class="comment"> *     server_url - zero terminated string with server address and port, </span>
00153 <span class="comment"> *                  for example "localhost:5101", "195.239.208.240:6100",...</span>
00154 <span class="comment"> *     max_connect_attempts  - number of attempts to establish connection</span>
00155 <span class="comment"> *     reconnect_timeout_sec - timeput in seconds between connection attempts</span>
00156 <span class="comment"> * Returns:</span>
00157 <span class="comment"> *     &gt;= 0 - connectiondescriptor to be used in all other cli calls</span>
00158 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00159 <span class="comment"> */</span>
00160 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_open(<span class="keywordtype">char</span> <span class="keyword">const</span>* server_url, 
00161                               <span class="keywordtype">int</span>         max_connect_attempts,
00162                               <span class="keywordtype">int</span>         reconnect_timeout_sec);
00163 
00164 <span class="keyword">enum</span> cli_open_attributes { 
00165     cli_open_default    = 0x0, 
00166     cli_open_readonly   = 0x1, 
00167     cli_open_truncate   = 0x2,
00168     cli_open_concurrent = 0x4
00169 };
00170 <span class="comment">/*********************************************************************</span>
00171 <span class="comment"> * cli_create</span>
00172 <span class="comment"> *     Create connection to the local database</span>
00173 <span class="comment"> * Parameters:</span>
00174 <span class="comment"> *     databaseName - name of the database </span>
00175 <span class="comment"> *     fileName - path to the database file </span>
00176 <span class="comment"> *     transactionCommitDelay - trasnaction commit delay (specify 0 to disable)</span>
00177 <span class="comment"> *     openAttr - mask of cli_open_attributes</span>
00178 <span class="comment"> *     initDatabaseSize - initial size of the database</span>
00179 <span class="comment"> *     extensionQuantum - database extension quantum</span>
00180 <span class="comment"> *     initIndexSize - initial size of object index</span>
00181 <span class="comment"> *     fileSizeLimit - limit for file size (0 - unlimited)</span>
00182 <span class="comment"> * Returns:</span>
00183 <span class="comment"> *     &gt;= 0 - connection descriptor to be used in all other cli calls</span>
00184 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00185 <span class="comment"> */</span>
00186 
00187 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_create(<span class="keywordtype">char</span> <span class="keyword">const</span>* databaseName, 
00188                                 <span class="keywordtype">char</span> <span class="keyword">const</span>* filePath, 
00189                                 <span class="keywordtype">unsigned</span>    transactionCommitDelay, 
00190                                 <span class="keywordtype">int</span>         openAttr, 
00191                                 size_t      initDatabaseSize,
00192                                 size_t      extensionQuantum,
00193                                 size_t      initIndexSize,
00194                                 size_t      fileSizeLimit);
00195     
00196 <span class="comment">/*********************************************************************</span>
00197 <span class="comment"> * cli_create_replication_node</span>
00198 <span class="comment"> *     Create connection to the local database with support of replication</span>
00199 <span class="comment"> * Parameters:</span>
00200 <span class="comment"> *     nodeId - node identifier: 0 &lt;= nodeId &lt; nServers</span>
00201 <span class="comment"> *     nServers - number of replication nodes (primary + standby)</span>
00202 <span class="comment"> *     nodeNames - array with URLs of the nodes (address:port)</span>
00203 <span class="comment"> *     databaseName - name of the database </span>
00204 <span class="comment"> *     fileName - path to the database file </span>
00205 <span class="comment"> *     transactionCommitDelay - trasnaction commit delay (specify 0 to disable)</span>
00206 <span class="comment"> *     openAttr - mask of cli_open_attributes (to allow concurrent read access to replication node, </span>
00207 <span class="comment"> *                cli_open_concurrent attribute should be set) </span>
00208 <span class="comment"> *     initDatabaseSize - initial size of the database</span>
00209 <span class="comment"> *     extensionQuantum - database extension quantum</span>
00210 <span class="comment"> *     initIndexSize - initial size of object index</span>
00211 <span class="comment"> *     fileSizeLimit - limit for file size (0 - unlimited)</span>
00212 <span class="comment"> * Returns:</span>
00213 <span class="comment"> *     &gt;= 0 - connection descriptor to be used in all other cli calls</span>
00214 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00215 <span class="comment"> */</span>
00216 
00217 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_create_replication_node(<span class="keywordtype">int</span>         nodeId,
00218                                                  <span class="keywordtype">int</span>         nServers,
00219                                                  <span class="keywordtype">char</span>*       nodeNames[],
00220                                                  <span class="keywordtype">char</span> <span class="keyword">const</span>* databaseName, 
00221                                                  <span class="keywordtype">char</span> <span class="keyword">const</span>* filePath, 
00222                                                  <span class="keywordtype">int</span>         openAttr, 
00223                                                  size_t      initDatabaseSize,
00224                                                  size_t      extensionQuantum,
00225                                                  size_t      initIndexSize,
00226                                                  size_t      fileSizeLimit);
00227 
00228 <span class="comment">/*********************************************************************</span>
00229 <span class="comment"> * cli_close</span>
00230 <span class="comment"> *     Close session</span>
00231 <span class="comment"> * Parameters:</span>
00232 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00233 <span class="comment"> * Returns:</span>
00234 <span class="comment"> *     result code as described in cli_result_code enum</span>
00235 <span class="comment"> */</span>
00236 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_close(<span class="keywordtype">int</span> session);
00237 
00238 <span class="comment">/*********************************************************************</span>
00239 <span class="comment"> * cli_statement</span>
00240 <span class="comment"> *     Specify SubSQL statement to be executed at server</span>
00241 <span class="comment"> *     Binding to the parameters and columns can be established       </span>
00242 <span class="comment"> * Parameters:</span>
00243 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00244 <span class="comment"> *     stmt    - zero terminated string with SubSQL statement  </span>
00245 <span class="comment"> * Returns:</span>
00246 <span class="comment"> *     &gt;= 0 - statement descriptor</span>
00247 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00248 <span class="comment"> */</span>
00249 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_statement(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* stmt);
00250 
00251 <span class="comment">/*********************************************************************</span>
00252 <span class="comment"> * cli_parameter</span>
00253 <span class="comment"> *     Bind parameter to the statement</span>
00254 <span class="comment"> * Parameters:</span>
00255 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00256 <span class="comment"> *     param_name - zero terminated string with parameter name  </span>
00257 <span class="comment"> *                  Paramter name should start with '%'</span>
00258 <span class="comment"> *     var_type   - type of variable as described in cli_var_type enum.</span>
00259 <span class="comment"> *                  Only scalar and zero terminated string types are supported.</span>
00260 <span class="comment"> *     var_ptr    - pointer to the variable</span>
00261 <span class="comment"> * Returns:</span>
00262 <span class="comment"> *     result code as described in cli_result_code enum</span>
00263 <span class="comment"> */</span>
00264 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_parameter(<span class="keywordtype">int</span>         statement,
00265                                    <span class="keywordtype">char</span> <span class="keyword">const</span>* param_name, 
00266                                    <span class="keywordtype">int</span>         var_type,
00267                                    <span class="keywordtype">void</span>*       var_ptr);
00268 
00269 <span class="comment">/*********************************************************************</span>
00270 <span class="comment"> * cli_column</span>
00271 <span class="comment"> *     Bind extracted column of select or insert statement</span>
00272 <span class="comment"> * Parameters:</span>
00273 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00274 <span class="comment"> *     column_name - zero terminated string with column name  </span>
00275 <span class="comment"> *     var_type    - type of variable as described in cli_var_type enum</span>
00276 <span class="comment"> *     var_len     - pointer to the variable to hold length of array variable.</span>
00277 <span class="comment"> *                   This variable should be assigned the maximal length</span>
00278 <span class="comment"> *                   of the array/string buffer, pointed by var_ptr.</span>
00279 <span class="comment"> *                   After the execution of the statement it is assigned the </span>
00280 <span class="comment"> *                   real length of the fetched array/string. If it is large </span>
00281 <span class="comment"> *                   than length of the buffer, then only part of the array</span>
00282 <span class="comment"> *                   will be placed in the buffer, but var_len still will </span>
00283 <span class="comment"> *                   contain the actual array length. </span>
00284 <span class="comment"> *     var_ptr     - pointer to the variable</span>
00285 <span class="comment"> * Returns:</span>
00286 <span class="comment"> *     result code as described in cli_result_code enum</span>
00287 <span class="comment"> */</span>
00288 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_column(<span class="keywordtype">int</span>         statement,
00289                                 <span class="keywordtype">char</span> <span class="keyword">const</span>* column_name, 
00290                                 <span class="keywordtype">int</span>         var_type, 
00291                                 <span class="keywordtype">int</span>*        var_len, 
00292                                 <span class="keywordtype">void</span>*       var_ptr);
00293 
00294 
00295 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* (CLI_CALLBACK_CC *cli_column_set)(<span class="keywordtype">int</span> var_type, <span class="keywordtype">void</span>* var_ptr, <span class="keywordtype">int</span> len);
00296 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* (CLI_CALLBACK_CC *cli_column_get)(<span class="keywordtype">int</span> var_type, <span class="keywordtype">void</span>* var_ptr, <span class="keywordtype">int</span>* len);
00297 
00298 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* (CLI_CALLBACK_CC *cli_column_set_ex)(<span class="keywordtype">int</span> var_type, <span class="keywordtype">void</span>* var_ptr, <span class="keywordtype">int</span> len, 
00299                                    <span class="keywordtype">char</span> <span class="keyword">const</span>* column_name, <span class="keywordtype">int</span> statement, <span class="keywordtype">void</span> <span class="keyword">const</span>* data_ptr, <span class="keywordtype">void</span>* user_data);
00300 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* (CLI_CALLBACK_CC *cli_column_get_ex)(<span class="keywordtype">int</span> var_type, <span class="keywordtype">void</span>* var_ptr, <span class="keywordtype">int</span>* len, 
00301                                    <span class="keywordtype">char</span> <span class="keyword">const</span>* column_name, <span class="keywordtype">int</span> statemen, <span class="keywordtype">void</span>* user_data);
00302 
00303 <span class="comment">/*********************************************************************</span>
00304 <span class="comment"> * cli_array_column</span>
00305 <span class="comment"> *     Specify get/set functions for the array column</span>
00306 <span class="comment"> * Parameters:</span>
00307 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00308 <span class="comment"> *     column_name - zero terminated string with column name  </span>
00309 <span class="comment"> *     var_type    - type of variable as described in cli_var_type enum</span>
00310 <span class="comment"> *     var_ptr     - pointer to the variable</span>
00311 <span class="comment"> *     set         - function which will be called to construct fetched </span>
00312 <span class="comment"> *                   field. It receives pointer to the variable, </span>
00313 <span class="comment"> *                   length of the fetched array and returns pointer to th </span>
00314 <span class="comment"> *                   array's elements</span>
00315 <span class="comment"> *     get         - function which will be called to update the field in the </span>
00316 <span class="comment"> *                   database. Given pointer to the variable, it should return </span>
00317 <span class="comment"> *                   pointer to the array elements and store length of the</span>
00318 <span class="comment"> *                   array to the variable pointer by len parameter</span>
00319 <span class="comment"> *     user_data   - pointer to user specific data passed to get and set functions</span>
00320 <span class="comment"> * Returns:</span>
00321 <span class="comment"> *     result code as described in cli_result_code enum</span>
00322 <span class="comment"> */</span>
00323 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_array_column(<span class="keywordtype">int</span>            statement,
00324                                       <span class="keywordtype">char</span> <span class="keyword">const</span>*    column_name, 
00325                                       <span class="keywordtype">int</span>            var_type,
00326                                       <span class="keywordtype">void</span>*          var_ptr,
00327                                       cli_column_set set,
00328                                       cli_column_get get);
00329     
00330 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_array_column_ex(<span class="keywordtype">int</span>               statement,
00331                                          <span class="keywordtype">char</span> <span class="keyword">const</span>*       column_name, 
00332                                          <span class="keywordtype">int</span>               var_type,
00333                                          <span class="keywordtype">void</span>*             var_ptr,
00334                                          cli_column_set_ex set,
00335                                          cli_column_get_ex get, 
00336                                          <span class="keywordtype">void</span>*             user_data);
00337     
00338 <span class="keyword">enum</span> { 
00339     cli_view_only, 
00340     cli_for_update
00341 };
00342 
00343 <span class="comment">/*********************************************************************</span>
00344 <span class="comment"> * cli_fetch</span>
00345 <span class="comment"> *     Execute select statement.</span>
00346 <span class="comment"> * Parameters:</span>
00347 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00348 <span class="comment"> *     for_update - not zero if fetched rows will be updated </span>
00349 <span class="comment"> * Returns:</span>
00350 <span class="comment"> *     &gt;= 0 - success, for select statements number of fetched rows is returned</span>
00351 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00352 <span class="comment"> */</span>
00353 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_fetch(<span class="keywordtype">int</span> statement, <span class="keywordtype">int</span> for_update);
00354 
00355 <span class="comment">/*********************************************************************</span>
00356 <span class="comment"> * cli_insert</span>
00357 <span class="comment"> *     Execute insert statement.</span>
00358 <span class="comment"> * Parameters:</span>
00359 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00360 <span class="comment"> *     oid        - object identifier of created record. </span>
00361 <span class="comment"> * Returns:</span>
00362 <span class="comment"> *     status code as described in cli_result_code enum</span>
00363 <span class="comment"> */</span>
00364 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_insert(<span class="keywordtype">int</span> statement, cli_oid_t* oid);
00365 
00366 <span class="comment">/*********************************************************************</span>
00367 <span class="comment"> * cli_get_first</span>
00368 <span class="comment"> *     Get first row of the selection.</span>
00369 <span class="comment"> * Parameters:</span>
00370 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00371 <span class="comment"> * Returns:</span>
00372 <span class="comment"> *     result code as described in cli_result_code enum</span>
00373 <span class="comment"> */</span>
00374 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_first(<span class="keywordtype">int</span> statement);
00375 
00376 <span class="comment">/*********************************************************************</span>
00377 <span class="comment"> * cli_get_last</span>
00378 <span class="comment"> *     Get last row of the selection.</span>
00379 <span class="comment"> * Parameters:</span>
00380 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00381 <span class="comment"> * Returns:</span>
00382 <span class="comment"> *     result code as described in cli_result_code enum</span>
00383 <span class="comment"> */</span>
00384 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_last(<span class="keywordtype">int</span> statement);
00385 
00386 <span class="comment">/*********************************************************************</span>
00387 <span class="comment"> * cli_get_next</span>
00388 <span class="comment"> *     Get next row of the selection. If get_next records is called</span>
00389 <span class="comment"> *     exactly after cli_fetch function call, is will fetch the first record</span>
00390 <span class="comment"> *     in selection.</span>
00391 <span class="comment"> * Parameters:</span>
00392 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00393 <span class="comment"> * Returns:</span>
00394 <span class="comment"> *     result code as described in cli_result_code enum</span>
00395 <span class="comment"> */</span>
00396 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_next(<span class="keywordtype">int</span> statement);
00397 
00398 <span class="comment">/*********************************************************************</span>
00399 <span class="comment"> * cli_get_prev</span>
00400 <span class="comment"> *     Get previous row of the selection. If get_next records is called</span>
00401 <span class="comment"> *     exactly after cli_fetch function call, is will fetch the last record</span>
00402 <span class="comment"> *     in selection.</span>
00403 <span class="comment"> * Parameters:</span>
00404 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00405 <span class="comment"> * Returns:</span>
00406 <span class="comment"> *     result code as described in cli_result_code enum</span>
00407 <span class="comment"> */</span>
00408 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_prev(<span class="keywordtype">int</span> statement);
00409 
00410 <span class="comment">/*********************************************************************</span>
00411 <span class="comment"> * cli_skip</span>
00412 <span class="comment"> *     Skip specified number of rows. </span>
00413 <span class="comment"> * Parameters:</span>
00414 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00415 <span class="comment"> *     n          - number of objects to be skipped</span>
00416 <span class="comment"> *                - if "n" is positive, then this function has the same effect as</span>
00417 <span class="comment"> *                     executing cli_get_next() function "n" times.</span>
00418 <span class="comment"> *                - if "n" is negative, then this function has the same effect as</span>
00419 <span class="comment"> *                     executing cli_get_prev() function "-n" times.</span>
00420 <span class="comment"> *                - if "n"  is zero, this method just reloads current record</span>
00421 <span class="comment"> * Returns:</span>
00422 <span class="comment"> *     result code as described in cli_result_code enum</span>
00423 <span class="comment"> */</span>
00424 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_skip(<span class="keywordtype">int</span> statement, <span class="keywordtype">int</span> n);
00425 
00426 <span class="comment">/*********************************************************************</span>
00427 <span class="comment"> * cli_seek</span>
00428 <span class="comment"> *    Position cursor to the record with specified OID</span>
00429 <span class="comment"> * Parameters:</span>
00430 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00431 <span class="comment"> *     oid         - object identifier of the record to which cursor should be positioned</span>
00432 <span class="comment"> * Returns:</span>
00433 <span class="comment"> *     &gt;= 0 - success, position of the record in the selection</span>
00434 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00435 <span class="comment"> */</span>
00436 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_seek(<span class="keywordtype">int</span> statement, cli_oid_t oid);
00437 
00438 
00439 <span class="comment">/*********************************************************************</span>
00440 <span class="comment"> * cli_get_oid</span>
00441 <span class="comment"> *     Get object identifier of the current record</span>
00442 <span class="comment"> * Parameters:</span>
00443 <span class="comment"> *     statement  - statememt descriptor returned by cli_statement</span>
00444 <span class="comment"> * Returns:</span>
00445 <span class="comment"> *     object identifier or 0 if no object is seleected</span>
00446 <span class="comment"> */</span>
00447 cli_oid_t FASTDB_DLL_ENTRY cli_get_oid(<span class="keywordtype">int</span> statement);
00448 
00449 <span class="comment">/*********************************************************************</span>
00450 <span class="comment"> * cli_update</span>
00451 <span class="comment"> *     Update the current row in the selection. You have to set</span>
00452 <span class="comment"> *     for_update parameter of cli_fetch to 1 in order to be able </span>
00453 <span class="comment"> *     to perform updates. Updated value of row fields will be taken</span>
00454 <span class="comment"> *     from bound column variables. </span>
00455 <span class="comment"> * Parameters:</span>
00456 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00457 <span class="comment"> * Returns:</span>
00458 <span class="comment"> *     result code as described in cli_result_code enum</span>
00459 <span class="comment"> */</span>
00460 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_update(<span class="keywordtype">int</span> statement);
00461 
00462 <span class="comment">/*********************************************************************</span>
00463 <span class="comment"> * cli_remove</span>
00464 <span class="comment"> *     Remove all selected records. You have to set</span>
00465 <span class="comment"> *     for_update parameter of cli_fetch to 1 in order to be able </span>
00466 <span class="comment"> *     to remove records. </span>
00467 <span class="comment"> * Parameters:</span>
00468 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00469 <span class="comment"> * Returns:</span>
00470 <span class="comment"> *     result code as described in cli_result_code enum</span>
00471 <span class="comment"> */</span>
00472 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_remove(<span class="keywordtype">int</span> statement);
00473 
00474 <span class="comment">/*********************************************************************</span>
00475 <span class="comment"> * cli_remove_current</span>
00476 <span class="comment"> *     Remove currently selected record. You have to set</span>
00477 <span class="comment"> *     for_update parameter of cli_fetch to 1 in order to be able</span>
00478 <span class="comment"> *     to remove records.</span>
00479 <span class="comment"> * Parameters:</span>
00480 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00481 <span class="comment"> * Returns:</span>
00482 <span class="comment"> *     result code as described in cli_result_code enum</span>
00483 <span class="comment"> */</span>
00484 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_remove_current(<span class="keywordtype">int</span> statement);
00485 
00486 <span class="comment">/*********************************************************************</span>
00487 <span class="comment"> * cli_free</span>
00488 <span class="comment"> *     Deallocate statement and all associated data</span>
00489 <span class="comment"> * Parameters:</span>
00490 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00491 <span class="comment"> * Returns:</span>
00492 <span class="comment"> *     result code as described in cli_result_code enum</span>
00493 <span class="comment"> */</span>
00494 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_free(<span class="keywordtype">int</span> statement);
00495 
00496 <span class="comment">/*********************************************************************</span>
00497 <span class="comment"> * cli_close_cursor</span>
00498 <span class="comment"> *     Close current cursor</span>
00499 <span class="comment"> * Parameters:</span>
00500 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00501 <span class="comment"> * Returns:</span>
00502 <span class="comment"> *     result code as described in cli_result_code enum</span>
00503 <span class="comment"> */</span>
00504 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_close_cursor(<span class="keywordtype">int</span> statement);
00505 
00506 <span class="comment">/*********************************************************************</span>
00507 <span class="comment"> * cli_commit</span>
00508 <span class="comment"> *     Commit current database transaction</span>
00509 <span class="comment"> * Parameters:</span>
00510 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00511 <span class="comment"> * Returns:</span>
00512 <span class="comment"> *     result code as described in cli_result_code enum</span>
00513 <span class="comment"> */</span>
00514 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_commit(<span class="keywordtype">int</span> session);
00515 
00516 <span class="comment">/*********************************************************************</span>
00517 <span class="comment"> * cli_precommit</span>
00518 <span class="comment"> *     Release all locks set by transaction. This methods allows other clients</span>
00519 <span class="comment"> *     to proceed, but it doesn't flush transaction to the disk.</span>
00520 <span class="comment"> * Parameters:</span>
00521 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00522 <span class="comment"> * Returns:</span>
00523 <span class="comment"> *     result code as described in cli_result_code enum</span>
00524 <span class="comment"> */</span>
00525 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_precommit(<span class="keywordtype">int</span> session);
00526 
00527 <span class="comment">/*********************************************************************</span>
00528 <span class="comment"> * cli_abort</span>
00529 <span class="comment"> *     Abort current database transaction</span>
00530 <span class="comment"> * Parameters:</span>
00531 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00532 <span class="comment"> * Returns:</span>
00533 <span class="comment"> *     result code as described in cli_result_code enum</span>
00534 <span class="comment"> */</span>
00535 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_abort(<span class="keywordtype">int</span> session);
00536 
00537 
00538 <span class="keyword">enum</span> cli_field_flags { 
00539     cli_hashed           = 1, <span class="comment">/* field should be indexed usnig hash table */</span>
00540     cli_indexed          = 2, <span class="comment">/* field should be indexed using B-Tree */</span>
00541     cli_autoincremented  = 16 <span class="comment">/* field is assigned automaticall incremented value */</span>
00542 };
00543 
00544 <span class="keyword">typedef</span> <span class="keyword">struct </span>cli_field_descriptor { 
00545     <span class="keyword">enum</span> cli_var_type type;
00546     <span class="keywordtype">int</span>               flags;
00547     <span class="keywordtype">char</span> <span class="keyword">const</span>*       name;
00548     <span class="keywordtype">char</span> <span class="keyword">const</span>*       refTableName;
00549     <span class="keywordtype">char</span> <span class="keyword">const</span>*       inverseRefFieldName;
00550 } cli_field_descriptor;
00551 
00552 <span class="comment">/*********************************************************************</span>
00553 <span class="comment"> * cli_describe</span>
00554 <span class="comment"> *     Describe fields of specified table</span>
00555 <span class="comment"> * Parameters:</span>
00556 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00557 <span class="comment"> *     table   - name of the table</span>
00558 <span class="comment"> *     fields  - address of the pointer to the array of fields descriptors, </span>
00559 <span class="comment"> *               this array should be later deallocated by application by cli_free_memory()</span>
00560 <span class="comment"> * Returns:</span>
00561 <span class="comment"> *     &gt;= 0 - number of fields in the table</span>
00562 <span class="comment"> *     &lt; 0  - result code as described in cli_result_code enum</span>
00563 <span class="comment"> */</span>
00564 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_describe(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* table, cli_field_descriptor** fields);
00565 
00566 <span class="keyword">typedef</span> <span class="keyword">struct </span>cli_field_layout {
00567     cli_field_descriptor desc;
00568     <span class="keywordtype">int</span>                  offs;
00569     <span class="keywordtype">int</span>                  size;
00570 } cli_field_layout;
00571 
00572 <span class="comment">/*********************************************************************</span>
00573 <span class="comment"> * cli_describe_layout</span>
00574 <span class="comment"> *     Describe fields layout of specified table</span>
00575 <span class="comment"> * Parameters:</span>
00576 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00577 <span class="comment"> *     table   - name of the table</span>
00578 <span class="comment"> *     fields  - address of the pointer to the array of fields layout descriptors, </span>
00579 <span class="comment"> *               this array should be later deallocated by application by cli_free_memory()</span>
00580 <span class="comment"> *     rec_size - pointer to the location to receive size of the record. This size can be used by application to allocate buffer for cli_execute_query function</span>
00581 <span class="comment"> * Returns:</span>
00582 <span class="comment"> *     &gt;= 0 - number of fields in the table</span>
00583 <span class="comment"> *     &lt; 0  - result code as described in cli_result_code enum</span>
00584 <span class="comment"> */</span>
00585 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_describe_layout(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* table, cli_field_layout** fields, <span class="keywordtype">int</span>* rec_size);
00586 
00587 <span class="comment">/*********************************************************************</span>
00588 <span class="comment"> * cli_get_field_size</span>
00589 <span class="comment"> *     Calculate field size</span>
00590 <span class="comment"> * Parameters:</span>
00591 <span class="comment"> *     fields  - array with fields descriptors obtained using cli_describe function</span>
00592 <span class="comment"> *     field_no - number of the field</span>
00593 <span class="comment"> */</span>
00594 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_field_size(cli_field_descriptor* fields, <span class="keywordtype">int</span> field_no);
00595 
00596 <span class="comment">/*********************************************************************</span>
00597 <span class="comment"> * cli_get_field_offset</span>
00598 <span class="comment"> *     Calculate offset of the field </span>
00599 <span class="comment"> * Parameters:</span>
00600 <span class="comment"> *     fields  - array with fields descriptors obtained using cli_describe function</span>
00601 <span class="comment"> *     field_no - number of the field</span>
00602 <span class="comment"> */</span>
00603 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_field_offset(cli_field_descriptor* fields, <span class="keywordtype">int</span> field_no);
00604 
00605 
00606 <span class="keyword">typedef</span> <span class="keyword">struct </span>cli_table_descriptor {
00607     <span class="keywordtype">char</span> <span class="keyword">const</span>*       name;
00608 } cli_table_descriptor;
00609 
00610 <span class="comment">/*********************************************************************</span>
00611 <span class="comment"> * cli_show_tables</span>
00612 <span class="comment"> *     Show all tables of specified database</span>
00613 <span class="comment"> * Parameters:</span>
00614 <span class="comment"> *     session - session descriptor as returned by cli_open</span>
00615 <span class="comment"> *     tables  - address of the pointer to the array of tables descriptors,</span>
00616 <span class="comment"> *               this array should be later deallocated by application by cli_free_memory()</span>
00617 <span class="comment"> * Returns:</span>
00618 <span class="comment"> *     &gt;= 0 - number of tables in the database (Metatable is not returned/counted)</span>
00619 <span class="comment"> *     &lt; 0  - result code as described in cli_result_code enum</span>
00620 <span class="comment"> */</span>
00621 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_show_tables(<span class="keywordtype">int</span> session, cli_table_descriptor** tables);
00622 
00623 
00624 <span class="comment">/*********************************************************************</span>
00625 <span class="comment"> * cli_create_table</span>
00626 <span class="comment"> *     Create new table</span>
00627 <span class="comment"> * Parameters:</span>
00628 <span class="comment"> *     session   - session descriptor as returned by cli_open</span>
00629 <span class="comment"> *     tableName - name of new table</span>
00630 <span class="comment"> *     nFields   - number of columns in the table</span>
00631 <span class="comment"> *     fields    - array with table columns descriptors</span>
00632 <span class="comment"> * Returns:</span>
00633 <span class="comment"> *     result code as described in cli_result_code enum</span>
00634 <span class="comment"> */</span>
00635 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_create_table(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* tableName, <span class="keywordtype">int</span> nFields, 
00636                                         cli_field_descriptor* fields);
00637 
00638 <span class="comment">/*********************************************************************</span>
00639 <span class="comment"> * cli_alter_table</span>
00640 <span class="comment"> *     Change table format</span>
00641 <span class="comment"> * Parameters:</span>
00642 <span class="comment"> *     session   - session descriptor as returned by cli_open</span>
00643 <span class="comment"> *     tableName - name of existing table</span>
00644 <span class="comment"> *     nFields   - number of columns in the table</span>
00645 <span class="comment"> *     fields    - array with new table columns descriptors</span>
00646 <span class="comment"> * Returns:</span>
00647 <span class="comment"> *     result code as described in cli_result_code enum</span>
00648 <span class="comment"> */</span>
00649 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_alter_table(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* tableName, <span class="keywordtype">int</span> nFields, 
00650                                      cli_field_descriptor* fields);
00651 
00652 <span class="comment">/*********************************************************************</span>
00653 <span class="comment"> * cli_drop_table</span>
00654 <span class="comment"> *     drop the table</span>
00655 <span class="comment"> * Parameters:</span>
00656 <span class="comment"> *     session   - session descriptor as returned by cli_open</span>
00657 <span class="comment"> *     tableName - name of deleted table</span>
00658 <span class="comment"> * Returns:</span>
00659 <span class="comment"> *     result code as described in cli_result_code enum</span>
00660 <span class="comment"> */</span>
00661 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_drop_table(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* tableName);
00662 
00663 
00664 <span class="comment">/*********************************************************************</span>
00665 <span class="comment"> * cli_alter_index</span>
00666 <span class="comment"> *     add or remove column index</span>
00667 <span class="comment"> * Parameters:</span>
00668 <span class="comment"> *     session   - session descriptor as returned by cli_open</span>
00669 <span class="comment"> *     tableName - name of the table</span>
00670 <span class="comment"> *     fieldName - name of field</span>
00671 <span class="comment"> *     newFlags  - new flags of the field, if index exists for this field, but is not specified in </span>
00672 <span class="comment"> *                 &lt;code&gt;newFlags&lt;/code&gt; mask, then it will be removed; if index not exists, but is </span>
00673 <span class="comment"> *                 specified in &lt;code&gt;newFlags&lt;/code&gt; mask, then it will be created. *                   </span>
00674 <span class="comment"> * Returns:</span>
00675 <span class="comment"> *     result code as described in cli_result_code enum</span>
00676 <span class="comment"> */</span>
00677 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_alter_index(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* tableName, <span class="keywordtype">char</span> <span class="keyword">const</span>* fieldName, 
00678                                      <span class="keywordtype">int</span> newFlags);
00679 
00680 
00681 <span class="comment">/*********************************************************************</span>
00682 <span class="comment"> * cli_set_error_handler</span>
00683 <span class="comment"> *     Set FastDB erro handler. Handler should be no-return function which perform stack unwind.</span>
00684 <span class="comment"> * Parameters:</span>
00685 <span class="comment"> *     session   - session descriptor as returned by cli_open</span>
00686 <span class="comment"> *     handler   - error handler</span>
00687 <span class="comment"> *     context   - error handler context: pointer to the user specific data</span>
00688 <span class="comment"> *                  which will be passed to thr handler</span>
00689 <span class="comment"> * Returns:</span>
00690 <span class="comment"> *     previous handler</span>
00691 <span class="comment"> */</span>
00692 <span class="keyword">enum</span> cli_error_class { 
00693     cli_no_error, 
00694     cli_query_error,
00695     cli_arithmetic_error,
00696     cli_index_out_of_range_error,
00697     cli_database_open_error,
00698     cli_file_error,
00699     cli_out_of_memory_error,
00700     cli_deadlock,
00701     cli_null_reference_error,
00702     cli_lock_revoked,
00703     cli_file_limit_exeeded        
00704 };
00705 <span class="keyword">typedef</span> void (CLI_CALLBACK_CC *cli_error_handler)(<span class="keywordtype">int</span> error, <span class="keywordtype">char</span> <span class="keyword">const</span>* msg, <span class="keywordtype">int</span> msgarg, <span class="keywordtype">void</span>* context); 
00706 cli_error_handler FASTDB_DLL_ENTRY cli_set_error_handler(<span class="keywordtype">int</span> session, cli_error_handler new_handler, <span class="keywordtype">void</span>* context);
00707 
00708 <span class="comment">/*********************************************************************</span>
00709 <span class="comment"> * cli_freeze</span>
00710 <span class="comment"> *    Freeze cursor. Make it possible to reused cursor after commit of the current transaction.</span>
00711 <span class="comment"> * Parameters:</span>
00712 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00713 <span class="comment"> * Returns:</span>
00714 <span class="comment"> *     result code as described in cli_result_code enum</span>
00715 <span class="comment"> */</span>
00716 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_freeze(<span class="keywordtype">int</span> statement);
00717 
00718 <span class="comment">/*********************************************************************</span>
00719 <span class="comment"> * cli_unfreeze</span>
00720 <span class="comment"> *    Unfreeze cursor. Reuse previously frozen cursor.</span>
00721 <span class="comment"> * Parameters:</span>
00722 <span class="comment"> *     statement   - statememt descriptor returned by cli_statement</span>
00723 <span class="comment"> * Returns:</span>
00724 <span class="comment"> *     result code as described in cli_result_code enum</span>
00725 <span class="comment"> */</span>
00726 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_unfreeze(<span class="keywordtype">int</span> statement);
00727 
00728 
00729 <span class="comment">/*********************************************************************</span>
00730 <span class="comment"> * cli_attach</span>
00731 <span class="comment"> *    Attach thread to the database. Each thread except one opened the database should first</span>
00732 <span class="comment"> *    attach to the database before any access to the database, and detach after end of the work with database</span>
00733 <span class="comment"> * Parameters:</span>
00734 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00735 <span class="comment"> * Returns:</span>
00736 <span class="comment"> *     result code as described in cli_result_code enum</span>
00737 <span class="comment"> */</span>
00738 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_attach(<span class="keywordtype">int</span> session);
00739 
00740 <span class="comment">/*********************************************************************</span>
00741 <span class="comment"> * cli_detach</span>
00742 <span class="comment"> *    Detach thread from the database. Each thread except one opened the database should perform </span>
00743 <span class="comment"> *    attach to the database before any access to the database, and detach after end of the work with database</span>
00744 <span class="comment"> * Parameters:</span>
00745 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00746 <span class="comment"> *     detach_mode - bit mask representing detach mode</span>
00747 <span class="comment"> * Returns:</span>
00748 <span class="comment"> *     result code as described in cli_result_code enum</span>
00749 <span class="comment"> */</span>
00750 <span class="keyword">enum</span> cli_detach_mode {
00751     cli_commit_on_detach          = 1,
00752     cli_destroy_context_on_detach = 2
00753 };
00754 
00755 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_detach(<span class="keywordtype">int</span> session, <span class="keywordtype">int</span> detach_mode);
00756 
00757 
00758 <span class="comment">/*********************************************************************</span>
00759 <span class="comment"> * cli_free_memory</span>
00760 <span class="comment"> *    Free memory allocated by cli_show_tables and cli_describe</span>
00761 <span class="comment"> * Parameters:</span>
00762 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00763 <span class="comment"> *     ptr - pointer to the allocated buffer</span>
00764 <span class="comment"> */</span>
00765 <span class="keywordtype">void</span> FASTDB_DLL_ENTRY cli_free_memory(<span class="keywordtype">int</span> session, <span class="keywordtype">void</span>* ptr);
00766 
00767 
00768 <span class="keyword">typedef</span> <span class="keyword">struct </span>cli_database_monitor {
00769     <span class="keywordtype">int</span> n_readers;
00770     <span class="keywordtype">int</span> n_writers;
00771     <span class="keywordtype">int</span> n_blocked_readers;
00772     <span class="keywordtype">int</span> n_blocked_writers;
00773     <span class="keywordtype">int</span> n_users;
00774 } cli_database_monitor;
00775 
00776 <span class="comment">/*********************************************************************</span>
00777 <span class="comment"> * cli_get_database_state</span>
00778 <span class="comment"> *    Obtain information about current state of the database</span>
00779 <span class="comment"> * Parameters:</span>
00780 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00781 <span class="comment"> *     monitor - pointer to the monitor structure. The folloing fields are set:</span>
00782 <span class="comment"> *       n_readers: number of granted shared locks</span>
00783 <span class="comment"> *       n_writers: number of granted exclusive locks</span>
00784 <span class="comment"> *       n_blocked_reader: number of threads which shared lock request was blocked</span>
00785 <span class="comment"> *       n_blocked_writers: number of threads which exclusive lock request was blocked</span>
00786 <span class="comment"> *       n_users: number of processes openned the database</span>
00787 <span class="comment"> * Returns:</span>
00788 <span class="comment"> *     result code as described in cli_result_code enum</span>
00789 <span class="comment"> */</span>
00790 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_get_database_state(<span class="keywordtype">int</span> session, cli_database_monitor* monitor);
00791 
00792 
00793 
00794 <span class="comment">/*********************************************************************</span>
00795 <span class="comment"> * cli_set_trace_function</span>
00796 <span class="comment"> *    Set trace function which will be used to output FastDB trace messages</span>
00797 <span class="comment"> * Parameters:</span>
00798 <span class="comment"> *     func - pointer to trace function which receives trace message terminated with new line character</span>
00799 <span class="comment"> */</span>
00800 <span class="keyword">typedef</span> void (CLI_CALLBACK_CC *cli_trace_function_t)(<span class="keywordtype">char</span>* msg);
00801 <span class="keywordtype">void</span> FASTDB_DLL_ENTRY cli_set_trace_function(cli_trace_function_t func);
00802 
00803 
00804 <span class="comment">/*********************************************************************</span>
00805 <span class="comment"> * cli_prepare_query</span>
00806 <span class="comment"> *     Prepare SubSQL query statement. </span>
00807 <span class="comment"> * Parameters:</span>
00808 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00809 <span class="comment"> *     query   - query string with optional parameters. Parameters are specified</span>
00810 <span class="comment"> *               as '%T' where T is one or two character code of parameter type using the same notation</span>
00811 <span class="comment"> *               as in printf: %d or %i - int, %f - float or double, %ld - int8, %s - string, %p - oid...</span>
00812 <span class="comment"> *               Parameter of cli_rectangle_t* type has format %R, cli_time_t type - %t</span>
00813 <span class="comment"> * Returns:</span>
00814 <span class="comment"> *     &gt;= 0 - statement descriptor</span>
00815 <span class="comment"> *     &lt;  0 - error code as described in cli_result_code enum</span>
00816 <span class="comment"> */</span>
00817 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_prepare_query(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* query);
00818 
00831 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_execute_query(<span class="keywordtype">int</span> statement, <span class="keywordtype">int</span> for_update, <span class="keywordtype">void</span>* record_struct, ...);
00832 
00847 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_execute_query_ex(<span class="keywordtype">int</span> statement, <span class="keywordtype">int</span> for_update, <span class="keywordtype">void</span>* record_struct, <span class="keywordtype">int</span> n_params, <span class="keywordtype">int</span>* param_types, <span class="keywordtype">void</span>** param_values);
00848 
00860 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_insert_struct(<span class="keywordtype">int</span> session, <span class="keywordtype">char</span> <span class="keyword">const</span>* table_name, <span class="keywordtype">void</span>* record_struct, cli_oid_t* oid);
00861 
00862 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* cli_transaction_context_t;
00863 <span class="comment">/*********************************************************************</span>
00864 <span class="comment"> * cli_create_transaction_context</span>
00865 <span class="comment"> *    Create new transaction xontext which can be used in cli_join_transaction function</span>
00866 <span class="comment"> * Parameters:</span>
00867 <span class="comment"> * Returns:</span>
00868 <span class="comment"> *     created transaction context</span>
00869 <span class="comment"> */</span>
00870  cli_transaction_context_t FASTDB_DLL_ENTRY cli_create_transaction_context();
00871 
00872 <span class="comment">/*********************************************************************</span>
00873 <span class="comment"> * cli_join_transaction</span>
00874 <span class="comment"> *    Associate current threads with specified transaction context,</span>
00875 <span class="comment"> *    It allows to share single transaction between multiple threads.</span>
00876 <span class="comment"> * Parameters:</span>
00877 <span class="comment"> *     session - session descriptor returned by cli_open</span>
00878 <span class="comment"> *     ctx     - transaction context created by cli_create_transaction_context</span>
00879 <span class="comment"> * Returns:</span>
00880 <span class="comment"> *     result code as described in cli_result_code enum</span>
00881 <span class="comment"> */</span>
00882 <span class="keywordtype">int</span> FASTDB_DLL_ENTRY cli_join_transaction(<span class="keywordtype">int</span> session, cli_transaction_context_t ctx);
00883 
00884 <span class="comment">/*********************************************************************</span>
00885 <span class="comment"> * cli_remove_transaction_context</span>
00886 <span class="comment"> *    Remove transaction context</span>
00887 <span class="comment"> * Parameters:</span>
00888 <span class="comment"> *     ctx  transaction context created by cli_create_transaction_context</span>
00889 <span class="comment"> */</span>
00890 <span class="keywordtype">void</span> FASTDB_DLL_ENTRY cli_remove_transaction_context(cli_transaction_context_t ctx);
00891 
00892 <span class="preprocessor">#ifdef __cplusplus</span>
00893 <span class="preprocessor"></span>}
00894 <span class="preprocessor">#endif</span>
00895 <span class="preprocessor"></span>
00896 <span class="preprocessor">#endif</span>
00897 <span class="preprocessor"></span>
00898 
</pre></div><hr><address style="align: right;"><small>Generated on Thu Feb 14 12:42:30 2008 for FastDB by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
